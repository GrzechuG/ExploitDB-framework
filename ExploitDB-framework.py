#!/usr/bin/python
import os
history = []
def banner():
   print"""
___________            .__         .__  __                .______.    
\_   _____/________  __|  |   ____ |__|/  |_            __| _/\_ |__  
 |    __)_\____ \  \/  /  |  /  _ \|  \   __\  ______  / __ |  | __ \ 
 |        \  |_> >    <|  |_(  <_> )  ||  |   /_____/ / /_/ |  | \_\ \\
/_______  /   __/__/\_ \____/\____/|__||__|           \____ |  |___  / 
        \/|__|        \/                                   \/      \/ 
___________                                                __         
\_   _____/___________    _____   ______  _  _____________|  | __     
 |    __) \_  __ \__  \  /     \_/ __ \ \/ \/ /  _ \_  __ \  |/ /     
 |     \   |  | \// __ \|  Y Y  \  ___/\     (  <_> )  | \/    <      
 \___  /   |__|  (____  /__|_|  /\___  >\/\_/ \____/|__|  |__|_ \     
     \/               \/      \/     \/                        \/     
"""
print "\n"
print "[-----------------Created by GrzechuG alias BlueHat139-----------------]"

banner()
print "For help run 'help'"
print "[----------------------------------------------------------------------]\n"
def clear():
    print "\n"*42
exploit_file=""
expl=""
while True:
    inside=False
    command = str(raw_input("edbf"+expl+"> "))
    if "search " in command:
        search=command.split("search ")[1]
        os.system("searchsploit "+search)
        inside=True
    if "use " in command:
        exploit = command.split("use ")[1]
        load = 'cp /usr/share/exploitdb/'+exploit +' ./exploits/'
        expl = " exploit("+exploit+") "
        os.system(load)
        exploit_file="./exploits/"+os.path.basename(exploit)
        os.system("chmod +x "+exploit_file+"")
        inside=True
    if " exploit " in command or command.startswith("exploit") or command.endswith("exploit"):
         interpreter = ""
         if exploit_file.endswith(".pl"):
             interpreter = "perl "
         if exploit_file.endswith(".py"):
             interpreter = "python "
         if exploit_file.endswith(".rb"):
             interpreter = "ruby "
         if exploit_file.endswith(".c"):
             os.system("gcc "+exploit_file+" -o ./exploits/compiled.bin")
             exploit_file = "./exploits/compiled.bin"

         print interpreter+command.replace("exploit", exploit_file)
         os.system(interpreter+command.replace("exploit", exploit_file))
         inside = True
    if "show" in command:
         inside=True
         os.system("cat -v "+exploit_file+"|more")
         inside = True
    if "back" in command:
         expl = "" 
         inside = True
    if "banner" in command:
         banner() 
         inside = True
    if "exit" in command:
         print "Bye. Maxwell will miss you..."
         quit()
    if "help" in command:
         print """
    Command       Description
    -------       -----------
    help          Help menu
    banner        Displays the title banner
    search        Search for exploit in exploit-db
    use           Downloads and loads exploit
    exploit       Runs loaded exploit with default interpreter, .c files are automaticly compiled
    show          Shows the content of exploit
    exit          Exit the console
    back          Unloads exploit
    [any other]   Is executed in bash
    
    Usage                               Example
    -------                             ---------
    exploit <option1> <option2> ...     exploit 8.8.8.8 21,   exploit -h
    use <exploit_path>                  use exploits/windows/remote/42315.py 
    search <query>                      search apache 2.2,    search eternalblue
    

 """
         inside = True
    if not inside:
        os.system(command)


